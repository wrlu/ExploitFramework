package com.wrlus.expfwk.cmd.control;

import android.content.Context;
import android.content.Intent;
import android.util.Log;
import com.wrlus.expfwk.cmd.Task;
import com.wrlus.expfwk.env.Env;

public class DexTask extends Task {
    private static final String TAG = "DexTask";
    private static final String ACTION_RECEIVE_DATA = "com.wrlus.expfwk.action.RECEIVE_DATA";
    private static final String RECEIVER_PERMISSION = "com.wrlus.expfwk.permission.RECEIVED_BROADCAST";
    private final String params;


    public DexTask(String params) {
        this.params = params;
    }
    public static void directCall(String params) {
        new DexTask(params).doTask();
    }
    @Override
    public void doTask() {
        Log.e(TAG, "Your typed text is : " + params);
        Context context = Env.getSystemContext();
        if (context != null) {
            context.sendBroadcast(getIntent(params), RECEIVER_PERMISSION);
        } else {
            Log.e(TAG, "Cannot get system context...");
        }
    }

    public Intent getIntent(String params) {
        Intent intent = new Intent();
        intent.setAction(ACTION_RECEIVE_DATA);
        intent.setPackage("com.wrlus.poc.appsign");
        intent.putExtra("params", params);
        return intent;
    }
}
