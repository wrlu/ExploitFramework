package com.wrlus.expfwk.cmd;

import java.util.regex.Matcher;
import java.util.regex.Pattern;


public abstract class Task {
    private static final String TAG = "Task";
    private static final Pattern pattern = Pattern.compile("(\\S*)\\s*(.*)");

    public static final String EXIT_TASK = "exit";
    public static final String QUIT_TASK = "quit";
    public static final String HELP_TASK = "help";
//    Show info of current process (uid, pid and UserHandle).
    public static final String INFO_TASK = "info";
//    List all granted permission.
    public static final String PERMISSION_TASK = "permission";
//    Install apk ./base.apk, needs INSTALL_PACKAGES permission.
    public static final String INSTALL_APK_TASK = "installapk";
    public static final String INSTALL_PACKAGE_TASK = "installpackage";
//    Read SMS, needs READ_SMS permission. (Cannot read auth codes & OTPs on some China ROMs)
    public static final String READ_SMS = "readsms";
//    Read Call Log, needs READ_CALL_LOG permission.
    public static final String READ_CALL_LOG = "readcalllog";
//    Call content provider
    public static final String CONTENT = "content";
//    List all installed packages.
    public static final String READ_APP_LIST = "package";
//    Launch a reverse shell
    public static final String REVERSE_SHELL = "rshell";

    public abstract void doTask();

    public static String[] resolveCmdAndParams(String input) {
        Matcher matcher = pattern.matcher(input);
        if (matcher.find()) {
            if (matcher.groupCount() == 2) {
                return new String[] { matcher.group(1), matcher.group(2) };
            } else if (matcher.groupCount() == 1) {
                return new String[] { matcher.group(1), null };
            }
        }
        return null;
    }

}
