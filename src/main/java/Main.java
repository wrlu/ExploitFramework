import android.os.Looper;

import com.wrlus.expfwk.cmd.Task;
import com.wrlus.expfwk.cmd.ExitTask;
import com.wrlus.expfwk.cmd.HelpTask;
import com.wrlus.expfwk.cmd.info.InfoTask;
import com.wrlus.expfwk.cmd.info.PermissionTask;
import com.wrlus.expfwk.cmd.control.ApkTask;
import com.wrlus.expfwk.cmd.privacy.SmsTask;
import com.wrlus.expfwk.cmd.privacy.CallLogTask;

import com.wrlus.expfwk.utils.LogUtil;

import java.util.Scanner;

public class Main {
    private static final String TAG = "Main";

    public static void showWelcome() {
        LogUtil.i(TAG, "============================================================");
        LogUtil.i(TAG, "");
        LogUtil.i(TAG, "Android Exploit Framework");
        LogUtil.i(TAG, "By wrlu (@xiaolulwr) of Singular Security Lab (@singularseclab)");
        LogUtil.i(TAG, "");
        LogUtil.i(TAG, "============================================================");
        LogUtil.i(TAG, "");
    }

    public static void main(String[] args)  {
        showWelcome();
        Looper.prepare();
        Scanner scanner = new Scanner(System.in);
        while (!Thread.currentThread().isInterrupted()) {
            System.out.print('>');
            String cmd = scanner.nextLine().trim().toLowerCase();
            Task task;
            switch (cmd) {
                case "":
                    continue;
                case Task.HELP_TASK:
                    task = new HelpTask();
                    break;
                case Task.EXIT_TASK:
                case Task.QUIT_TASK:
                    task = new ExitTask();
                    break;
                case Task.INFO_TASK:
                    task = new InfoTask();
                    break;
                case Task.PERMISSION_TASK:
                    task = new PermissionTask();
                    break;
                case Task.INSTALL_APK_TASK:
                case Task.INSTALL_PACKAGE_TASK:
                    task = new ApkTask();
                    break;
                case Task.READ_SMS:
                    task = new SmsTask();
                    break;
                case Task.READ_CALL_LOG:
                    task = new CallLogTask();
                    break;
                default:
                    LogUtil.e(TAG, "Unknown command: "+cmd);
                    continue;
            }
            task.doTask("./para.json");
        }
    }
}
